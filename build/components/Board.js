"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}function _iterableToArrayLimit(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],o=!0,i=!1,n=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(t.push(a.value),!r||t.length!==r);o=!0);}catch(e){i=!0,n=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw n}}return t}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var React=require("react"),_require=require("ink"),Box=_require.Box,Color=_require.Color,useInput=_require.useInput,importJsx=require("import-jsx"),Move=require("../models/move"),App=require("./App"),_require2=require("../helpers/cursorActions"),moveCursor=_require2.moveCursor,cursorDidMove=_require2.cursorDidMove,highlightPossibleMoves=_require2.highlightPossibleMoves,moveCursorOnPossibleMoves=_require2.moveCursorOnPossibleMoves,botMovePiece=require("../helpers/botAI"),Row=importJsx("../components/Row"),Board=function(){var e=React.useContext(App.GameContext),r=React.useContext(App.PlayerContext),t=r.player,o=r.setPlayer,i=r.player2,n=e.board,a=e.pieces,s=e.setGame,c=e.isWhiteTurn,u=_slicedToArray(React.useState([]),2),l=u[0],f=u[1],m=_slicedToArray(React.useState(),2),y=m[0],v=m[1],p=a.active.black.concat(a.active.white),d=t.cursorPosition,b=function(r,t){var o=new Move(n,r,t);!function(r){s(Object.assign(Object.assign({},e),r)),v(),f([])}(e.updateGame(o))};React.useEffect(function(){setTimeout(function(){c||botMovePiece(n,a,i,b)},500)},[c]),useInput(function(e,r){var i,s;if(0===l.length?o(Object.assign(Object.assign({},t),{cursorPosition:moveCursor(e,r,t)})):moveCursorOnPossibleMoves(l,t,o,r),l.length>0&&r.return)"w"===t.color?(i=a.active.white.find(function(e){return e._id===y._id}),s={x:d.x,y:d.y}):(i=a.active.black.find(function(e){return e._id===y._id}),s={x:d.x,y:d.y}),b(i,s);else if(r.return){var c=n[d.y][d.x];if(c.piece){var u=p.find(function(e){return e._id===c.piece._id});v(u)}highlightPossibleMoves(a,t,o,f,n)}});var h=function(e){if(e){for(var r=[],t=1;t<=8;t++)r.push(React.createElement(Color,{key:t,cyan:!0},t));return r}for(var o=[],i=0;i<8;i++)o.push(React.createElement(Color,{key:i,cyan:!0}," ",String.fromCharCode(97+i)));return o};return React.createElement(Box,{marginRight:3,flexDirection:"column"},React.createElement(Box,{flexDirection:"row"},React.createElement(Box,{flexDirection:"column-reverse",alignItems:"center",marginRight:1},h(1)),React.createElement(Box,{flexDirection:"column",alignItems:"center"},function(){var e=[];if("w"===t.color)for(var r=7;r>=0;r--)e.push(React.createElement(Row,{selectedPossibleMoves:l,key:r,rowIndex:r,spaces:n[r]}));else for(var o=0;o<8;o++)e.push(React.createElement(Row,{selectedPossibleMoves:l,key:o,rowIndex:o,spaces:n[o]}));return e}())),React.createElement(Box,{flexDirection:"row",marginLeft:1.5},h(0)))};module.exports=Board;